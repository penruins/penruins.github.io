<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="
  rabbitmq
  #


  main
  #


RabbitMQ

RabbitMQ Tutorials

Hello World
Work Queues

Distributing tasks among workers
一个生产者，多个消费者


Publish/Subscribe

Sending messages to many consumers at once
一个消息，每个消费者都能接收到


Routing

多个消费者订阅同一个生产者的消息, 通过路由键，选择性消费


Topics

通过匹配的方式来选择性接收


RPC






  rabbitmq有哪几种模式
  #


简单模式（Simple Mode）

描述：一个生产者（Producer）和一个消费者（Consumer），消息直接发送到队列中，不需要交换机（Exchange）。
特点：消息只能被一个消费者处理，适合简单的点对点通信。
应用场景：简单的任务队列，如日志收集。


工作队列模式（Work Queue Mode）

描述：一个生产者和多个消费者，消息分发到多个消费者，但每个消息只能被一个消费者处理。
特点：默认采用轮询机制分发消息，支持手动确认（ack）以确保消息处理成功。
应用场景：任务分发，如多个消费者处理不同的任务。


发布/订阅模式（Publish/Subscribe Mode）

描述：生产者将消息发送到交换机（Exchange），交换机将消息广播到所有绑定的队列，每个队列可以有多个消费者。
特点：使用 fanout 类型的交换机，消息会被所有消费者接收。
应用场景：消息广播，如通知多个系统或用户。


路由模式（Routing Mode）

描述：生产者将消息发送到交换机，交换机根据路由键（Routing Key）将消息分发到匹配的队列。
特点：使用 direct 类型的交换机，支持精确的路由规则。
应用场景：根据特定规则分发消息，如按日志级别分类。


主题模式（Topics Mode）

描述：类似于路由模式，但支持更灵活的路由规则，使用通配符（如 * 和 #）匹配路由键。
特点：使用 topic 类型的交换机，支持复杂的路由逻辑。
应用场景：需要灵活匹配和过滤消息的场景，如多维度消息分发。


RPC 模式（Remote Procedure Call Mode）

描述：生产者发送消息后，等待消费者处理并返回结果，类似于远程过程调用。
特点：通过回调队列实现请求和响应的匹配。
应用场景：需要同步返回结果的场景，如远程调用。


发布确认模式（Publisher Confirms Mode）

描述：生产者在发送消息后，等待 RabbitMQ 的确认，确保消息被成功接收。
特点：提高消息的可靠性，避免消息丢失。
应用场景：需要高可靠性的消息传递，如金融交易。


Header 模式（Headers Mode）

描述：根据消息的头部信息（Headers）进行路由，而不是依赖路由键。
特点：使用 headers 类型的交换机，支持复杂的匹配规则。
应用场景：需要根据消息属性进行路由的场景。




  rabbitmq有哪些类型的路由键
  #

在 RabbitMQ 中，路由键（Routing Key） 是用于决定消息如何被路由到队列的关键字。路由键的具体使用方式取决于 交换机类型，不同类型的交换机对路由键的处理方式不同。以下是 RabbitMQ 中常见的交换机类型及其对应的路由键使用方式：">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="/post/computer-science/distributed-system/message-queue/rabbitmq/">
  <meta property="og:site_name" content="Penruins">
  <meta property="og:title" content="rabbitmq">
  <meta property="og:description" content="rabbitmq # main # RabbitMQ RabbitMQ Tutorials Hello World Work Queues Distributing tasks among workers 一个生产者，多个消费者 Publish/Subscribe Sending messages to many consumers at once 一个消息，每个消费者都能接收到 Routing 多个消费者订阅同一个生产者的消息, 通过路由键，选择性消费 Topics 通过匹配的方式来选择性接收 RPC rabbitmq有哪几种模式 # 简单模式（Simple Mode） 描述：一个生产者（Producer）和一个消费者（Consumer），消息直接发送到队列中，不需要交换机（Exchange）。 特点：消息只能被一个消费者处理，适合简单的点对点通信。 应用场景：简单的任务队列，如日志收集。 工作队列模式（Work Queue Mode） 描述：一个生产者和多个消费者，消息分发到多个消费者，但每个消息只能被一个消费者处理。 特点：默认采用轮询机制分发消息，支持手动确认（ack）以确保消息处理成功。 应用场景：任务分发，如多个消费者处理不同的任务。 发布/订阅模式（Publish/Subscribe Mode） 描述：生产者将消息发送到交换机（Exchange），交换机将消息广播到所有绑定的队列，每个队列可以有多个消费者。 特点：使用 fanout 类型的交换机，消息会被所有消费者接收。 应用场景：消息广播，如通知多个系统或用户。 路由模式（Routing Mode） 描述：生产者将消息发送到交换机，交换机根据路由键（Routing Key）将消息分发到匹配的队列。 特点：使用 direct 类型的交换机，支持精确的路由规则。 应用场景：根据特定规则分发消息，如按日志级别分类。 主题模式（Topics Mode） 描述：类似于路由模式，但支持更灵活的路由规则，使用通配符（如 * 和 #）匹配路由键。 特点：使用 topic 类型的交换机，支持复杂的路由逻辑。 应用场景：需要灵活匹配和过滤消息的场景，如多维度消息分发。 RPC 模式（Remote Procedure Call Mode） 描述：生产者发送消息后，等待消费者处理并返回结果，类似于远程过程调用。 特点：通过回调队列实现请求和响应的匹配。 应用场景：需要同步返回结果的场景，如远程调用。 发布确认模式（Publisher Confirms Mode） 描述：生产者在发送消息后，等待 RabbitMQ 的确认，确保消息被成功接收。 特点：提高消息的可靠性，避免消息丢失。 应用场景：需要高可靠性的消息传递，如金融交易。 Header 模式（Headers Mode） 描述：根据消息的头部信息（Headers）进行路由，而不是依赖路由键。 特点：使用 headers 类型的交换机，支持复杂的匹配规则。 应用场景：需要根据消息属性进行路由的场景。 rabbitmq有哪些类型的路由键 # 在 RabbitMQ 中，路由键（Routing Key） 是用于决定消息如何被路由到队列的关键字。路由键的具体使用方式取决于 交换机类型，不同类型的交换机对路由键的处理方式不同。以下是 RabbitMQ 中常见的交换机类型及其对应的路由键使用方式：">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="post">
    <meta property="article:modified_time" content="2025-09-09T21:20:09+08:00">
<title>rabbitmq | Penruins</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="/post/computer-science/distributed-system/message-queue/rabbitmq/">
<link rel="stylesheet" href="/book.min.26e661cf8028ea69ebe162050990c3a07de74e5bfe9389e880f2d6a7e5fa587c.css" >
  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.b74ca8978e1e8635a5eaf7e94e0df38877d85fb3976cfc2b8576ca8edef840a0.js" ></script>
<!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->
  
</head>
<body dir="ltr">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    <aside class="book-menu">
      <div class="book-menu-content">
        
  
<nav>
    <h2 class="book-brand">
  <a class="flex align-center" href="/"><span>Penruins</span>
  </a>
</h2>

    
<div class="book-search hidden">
  <input type="text" id="book-search-input" placeholder="Search" aria-label="Search" maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>


    

    
    





    



  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1f044d5fe299e2a50ad480135136465e" class="toggle"  />
    <label for="section-1f044d5fe299e2a50ad480135136465e" class="flex justify-between">
      <a role="button" class="">Life</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/life/books/" class="">books</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/%E6%91%98%E6%8A%84%E5%88%86%E4%BA%AB/" class="">摘抄分享</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/%E6%96%B0%E7%9F%A5/" class="">新知</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/movies-log/" class="">观影记录</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/bilibili/" class="">bilibili</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/cycling/" class="">cycling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/hiking/" class="">hiking</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/life/" class="">life</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/life-recommend/" class="">life recommand</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/learning-others-log/" class="">other learning</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/podcast/" class="">podcast</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/politics/" class="">politics</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/goal/" class="">goal</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/coffee/" class="">coffee</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/article/" class="">article</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/life/law/" class="">law</a>
  

        </li>
      
    
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0e80d916dfbf49a298199837cff9b464" class="toggle" checked />
    <label for="section-0e80d916dfbf49a298199837cff9b464" class="flex justify-between">
      <a role="button" class="">Computer Science</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/computer-science/" class="">computer science</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-6731a574eaa5303011e73f04f85a6614" class="toggle"  />
    <label for="section-6731a574eaa5303011e73f04f85a6614" class="flex justify-between">
      <a role="button" class="">Algorithm</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/algorithm/algorithm/" class="">Algorithm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/algorithm/algorithm-practice-%E5%89%91%E6%8C%87-offer/" class="">algorithm practice 剑指 offer</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/algorithm/%E5%89%91%E6%8C%87offer%E8%BF%99%E6%9C%AC%E4%B9%A6%E4%B8%AD%E6%AF%8F%E4%B8%80%E9%81%93%E9%9D%A2%E8%AF%95%E9%A2%98%E5%AF%B9%E5%BA%94leetcode%E7%9A%84%E9%A2%98%E7%9B%AE/" class="">剑指offer题目对应</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/algorithm/%E9%9D%A2%E8%AF%95%E7%BB%8F%E5%85%B8150%E9%A2%98/" class="">面试经典 150 题</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7ab6eb16d87ee717ab25cc84269ec7f9" class="toggle"  />
    <label for="section-7ab6eb16d87ee717ab25cc84269ec7f9" class="flex justify-between">
      <a role="button" class="">Big Data</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/big-data/hadoop/" class="">hadoop</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/big-data/hbase/" class="">hbase</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/big-data/hive/" class="">hive</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-859fd182f99952efd6ae86320529c63d" class="toggle"  />
    <label for="section-859fd182f99952efd6ae86320529c63d" class="flex justify-between">
      <a role="button" class="">Database</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/database/" class="">database</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/druid/" class="">druid</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/elasticsearch/" class="">elasticsearch</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/mycat/" class="">mycat</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/mysql/" class="">mysql</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/postgresql/" class="">postgresql</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/shardingsphere/" class="">shardingsphere</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/sql/" class="">SQL</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/database/mongodb/" class="">Penruins</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-08231b363489d85c9f808700d743ce65" class="toggle" checked />
    <label for="section-08231b363489d85c9f808700d743ce65" class="flex justify-between">
      <a role="button" class="">Distributed System</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-92803a0b927e7b223b49867047da77ad" class="toggle" checked />
    <label for="section-92803a0b927e7b223b49867047da77ad" class="flex justify-between">
      <a role="button" class="">Message Queue</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/message-queue/kafka/" class="">kafka</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/message-queue/message-queue/" class="">Message Queue</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/message-queue/rabbitmq/" class="active">rabbitmq</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/distributed-system/" class="">distributed system</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/sentinel/" class="">Sentinel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/spring-cloud/" class="">Spring Cloud</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/distributed-system/spring-cloud-alibaba/" class="">Spring Cloud Alibaba</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ca0677f03580f20779b09f474723b113" class="toggle"  />
    <label for="section-ca0677f03580f20779b09f474723b113" class="flex justify-between">
      <a role="button" class="">Java</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/java-basic/" class="">java basic</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0881ddd207cd479aab0cacb25e32a397" class="toggle"  />
    <label for="section-0881ddd207cd479aab0cacb25e32a397" class="flex justify-between">
      <a role="button" class="">Spring</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/spring/spring/" class="">spring</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/spring/spring-transaction/" class="">spring transaction</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/spring/unit-test/" class="">unit test</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/java/" class="">java</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/concurrent/" class="">concurrent</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/jvm/" class="">jvm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/mybatis/" class="">Mybatis</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/mybatis-plus/" class="">Mybatis Plus</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/springboot/" class="">spring boot</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/java/xxl-job/" class="">xxl job</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-38c4d1edc00af801a5cead99c216a484" class="toggle"  />
    <label for="section-38c4d1edc00af801a5cead99c216a484" class="flex justify-between">
      <a role="button" class="">Monitor</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/monitor/prometheus/" class="">prometheus</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-580097d540eb28e9fcf7fd7cfd7cf3f5" class="toggle"  />
    <label for="section-580097d540eb28e9fcf7fd7cfd7cf3f5" class="flex justify-between">
      <a role="button" class="">Tools</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/tools/idea/" class="">IDEA</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/computer-science-recommend/" class="">推荐</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/computer-science-learning-log/" class="">学习记录</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/github/" class="">github</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/job/" class="">job</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/redis/" class="">redis</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/security/" class="">security</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-4a916c2b8e67363ceaa083cdbb8dbdad" class="toggle"  />
    <label for="section-4a916c2b8e67363ceaa083cdbb8dbdad" class="flex justify-between">
      <a role="button" class="">Blog</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/blog/blog/" class="">blog</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/blog/hugo/" class="">Hugo</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/cloud/" class="">Cloud</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9662d7fc288dd34ce9d64eacfae9d3cd" class="toggle"  />
    <label for="section-9662d7fc288dd34ce9d64eacfae9d3cd" class="flex justify-between">
      <a role="button" class="">Front End</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/front-end/echarts/" class="">echarts</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/front-end/vue/" class="">vue</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-268cb37854ca4d21d8c728981f1239bc" class="toggle"  />
    <label for="section-268cb37854ca4d21d8c728981f1239bc" class="flex justify-between">
      <a role="button" class="">Micro Service</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/micro-service/nacos/" class="">Nacos</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/micro-service/micro-service/" class="">micro service</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-08034345c59b2d801c96d3235471b850" class="toggle"  />
    <label for="section-08034345c59b2d801c96d3235471b850" class="flex justify-between">
      <a role="button" class="">Operating System</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/operating-system/ios/" class="">ios</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/operating-system/linux/" class="">linux</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/operating-system/mac/" class="">mac</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/operating-system/raspberrypi/" class="">raspberry pi</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/operating-system/powershell/" class="">powershell</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/operating-system/windows/" class="">windows</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/artificial-intelligence/" class="">Artificial Intelligence</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-91cda33c3f083dc425de7b0831dd4a4b" class="toggle"  />
    <label for="section-91cda33c3f083dc425de7b0831dd4a4b" class="flex justify-between">
      <a role="button" class="">CI/CD</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/ci-cd/gitlab/" class="">Gitlab</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/ci-cd/jenkins/" class="">Jenkins</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/ci-cd/maven/" class="">maven</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/ci-cd/nexus/" class="">Nexus</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/crawler/" class="">crawler</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/git/" class="">git</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/networking/" class="">networking</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/python/" class="">Python</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/reddison/" class="">reddison</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/vim/" class="">vim</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/" class="">系统设计</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/computer-science/%E8%BF%90%E7%BB%B4/" class="">运维</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3409a4049a7a8d62c70ecac8b1f58f2c" class="toggle"  />
    <label for="section-3409a4049a7a8d62c70ecac8b1f58f2c" class="flex justify-between">
      <a role="button" class="">History</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/history/chinese-history/" class="">Chinese History</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ddb61fbbb5f4750721f7a5d8dc727ca0" class="toggle"  />
    <label for="section-ddb61fbbb5f4750721f7a5d8dc727ca0" class="flex justify-between">
      <a role="button" class="">Others</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/others/about-me/" class="">about me</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/others/english-learning/" class="">English Learning</a>
  

        </li>
      
    
      
    
      
        <li>
          
  
  

  
    <a href="/post/others/economy/" class="">Economy</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/others/f1/" class="">F1</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-1fd19967e3118e0a4e018bc53fc62da9" class="toggle"  />
    <label for="section-1fd19967e3118e0a4e018bc53fc62da9" class="flex justify-between">
      <a role="button" class="">Science</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/science/biology/" class="">biology</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-f13963d33b0147768eccb2769cbf8a17" class="toggle"  />
    <label for="section-f13963d33b0147768eccb2769cbf8a17" class="flex justify-between">
      <a role="button" class="">Sports</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/sports/cycling/" class="">cycling</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/sports/table-tennis/" class="">table tennis</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-059e454079365a6cc43cf645255baa37" class="toggle"  />
    <label for="section-059e454079365a6cc43cf645255baa37" class="flex justify-between">
      <a role="button" class="">Wl Public</a>
    </label>
  

          
  <ul>
    
      
    
      
        <li>
          
  
  

  
    <a href="/post/wl-public/movies-log/" class="">movies log</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/wl-public/%E5%B9%BF%E5%B7%9E/" class="">广州</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b03f134e351d6516fb4925d3cccc721f" class="toggle"  />
    <label for="section-b03f134e351d6516fb4925d3cccc721f" class="flex justify-between">
      <a role="button" class="">Books</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3045b94b25ef0b17b04a92aba83672b7" class="toggle"  />
    <label for="section-3045b94b25ef0b17b04a92aba83672b7" class="flex justify-between">
      <a role="button" class="">Computer Science</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/books/computer-science/java%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E5%AE%9E%E6%88%98/" class="">Java并发编程实战</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/books/computer-science/python%E7%A5%9E%E7%BB%8F%E7%BD%91%E7%BB%9C%E7%BC%96%E7%A8%8B/" class="">Python神经网络编程</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/books/computer-science/redis%E8%AE%BE%E8%AE%A1%E4%B8%8E%E5%AE%9E%E7%8E%B0/" class="">Redis设计与实现</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/books/computer-science/spring-cloud%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E5%AE%9E%E6%88%98%E4%B8%8E%E8%BF%9B%E9%98%B6/" class="">Spring Cloud微服务：入门、实战与进阶</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/books/computer-science/%E4%B8%80%E6%9C%AC%E4%B9%A6%E8%AE%B2%E9%80%8F-elasticsearch%E5%8E%9F%E7%90%86%E8%BF%9B%E9%98%B6%E4%B8%8E%E5%B7%A5%E7%A8%8B%E5%AE%9E%E8%B7%B5/" class="">一本书讲透 ElasticSearch：原理、进阶与工程实践</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/books/%E5%AE%8F%E8%A7%82%E7%BB%8F%E6%B5%8E%E5%AD%A6-%E7%AC%AC%E4%B8%89%E7%89%88/" class="">宏观经济学 第三版</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/post/books/%E8%8B%B1%E4%BC%9F%E8%BE%BE-%E9%BB%84%E4%BB%81%E5%8B%8B%E4%B9%8B%E8%8A%AF/" class="">英伟达-黄仁勋之芯</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-7cc5838c1164863d0d61c597900732c7" class="toggle"  />
    <label for="section-7cc5838c1164863d0d61c597900732c7" class="flex justify-between">
      <a role="button" class="">Tools</a>
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/post/tools/obsidian/" class="">obsidian</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>








    




    
</nav>





  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>


 
      </div>
    </aside>

    <div class="book-page">
      <header class="book-header">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/svg/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>rabbitmq</h3>

  <label for="toc-control">
    
    <img src="/svg/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden clearfix">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#rabbitmq">rabbitmq</a></li>
    <li><a href="#main">main</a>
      <ul>
        <li><a href="#rabbitmq有哪几种模式">rabbitmq有哪几种模式</a></li>
        <li><a href="#rabbitmq有哪些类型的路由键">rabbitmq有哪些类型的路由键</a></li>
        <li><a href="#核心组件">核心组件</a></li>
        <li><a href="#rabbit可以实现高吞吐量吗">Rabbit可以实现高吞吐量吗</a>
          <ul>
            <li><a href="#4-实际应用建议">4. <strong>实际应用建议</strong></a></li>
          </ul>
        </li>
        <li><a href="#集群模式">集群模式</a></li>
        <li><a href="#rabbitmq的集群模式在实际项目中如何选型">RabbitMQ的集群模式在实际项目中如何选型</a></li>
        <li><a href="#rabbitmq可以像kafka一样把消费者平均分配到所有broker上吗">rabbitmq可以像kafka一样把消费者平均分配到所有broker上吗</a></li>
        <li><a href="#rabbitmq-为什么不能保证消息的顺序性">rabbitmq 为什么不能保证消息的顺序性</a></li>
        <li><a href="#如果只有一个生产者一个消费者消费者是单线程的能保证消息的顺序性吗">如果只有一个生产者一个消费者，消费者是单线程的，能保证消息的顺序性吗</a></li>
      </ul>
    </li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><h1 id="rabbitmq">
  rabbitmq
  <a class="anchor" href="#rabbitmq">#</a>
</h1>
<h1 id="main">
  main
  <a class="anchor" href="#main">#</a>
</h1>
<ul>
<li><a href="https://www.rabbitmq.com/">RabbitMQ</a>
<ul>
<li><a href="https://www.rabbitmq.com/tutorials">RabbitMQ Tutorials</a>
<ul>
<li><code>Hello World</code></li>
<li><code>Work Queues</code>
<ul>
<li>Distributing tasks among workers</li>
<li>一个生产者，多个消费者</li>
</ul>
</li>
<li><code>Publish/Subscribe</code>
<ul>
<li>Sending messages to many consumers at once</li>
<li>一个消息，每个消费者都能接收到</li>
</ul>
</li>
<li><code>Routing</code>
<ul>
<li>多个消费者订阅同一个生产者的消息, 通过路由键，选择性消费</li>
</ul>
</li>
<li><code>Topics</code>
<ul>
<li>通过匹配的方式来选择性接收</li>
</ul>
</li>
<li><code>RPC</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="rabbitmq有哪几种模式">
  rabbitmq有哪几种模式
  <a class="anchor" href="#rabbitmq%e6%9c%89%e5%93%aa%e5%87%a0%e7%a7%8d%e6%a8%a1%e5%bc%8f">#</a>
</h2>
<ul>
<li><strong>简单模式（Simple Mode）</strong>
<ul>
<li><strong>描述</strong>：一个生产者（Producer）和一个消费者（Consumer），消息直接发送到队列中，不需要交换机（Exchange）。</li>
<li><strong>特点</strong>：消息只能被一个消费者处理，适合简单的点对点通信。</li>
<li><strong>应用场景</strong>：简单的任务队列，如日志收集。</li>
</ul>
</li>
<li><strong>工作队列模式（Work Queue Mode）</strong>
<ul>
<li><strong>描述</strong>：一个生产者和多个消费者，消息分发到多个消费者，但每个消息只能被一个消费者处理。</li>
<li><strong>特点</strong>：默认采用轮询机制分发消息，支持手动确认（ack）以确保消息处理成功。</li>
<li><strong>应用场景</strong>：任务分发，如多个消费者处理不同的任务。</li>
</ul>
</li>
<li><strong>发布/订阅模式（Publish/Subscribe Mode）</strong>
<ul>
<li><strong>描述</strong>：生产者将消息发送到交换机（Exchange），交换机将消息广播到所有绑定的队列，每个队列可以有多个消费者。</li>
<li><strong>特点</strong>：使用 <strong>fanout</strong> 类型的交换机，消息会被所有消费者接收。</li>
<li><strong>应用场景</strong>：消息广播，如通知多个系统或用户。</li>
</ul>
</li>
<li><strong>路由模式（Routing Mode）</strong>
<ul>
<li><strong>描述</strong>：生产者将消息发送到交换机，交换机根据路由键（Routing Key）将消息分发到匹配的队列。</li>
<li><strong>特点</strong>：使用 <strong>direct</strong> 类型的交换机，支持精确的路由规则。</li>
<li><strong>应用场景</strong>：根据特定规则分发消息，如按日志级别分类。</li>
</ul>
</li>
<li><strong>主题模式（Topics Mode）</strong>
<ul>
<li><strong>描述</strong>：类似于路由模式，但支持更灵活的路由规则，使用通配符（如 <code>*</code> 和 <code>#</code>）匹配路由键。</li>
<li><strong>特点</strong>：使用 <strong>topic</strong> 类型的交换机，支持复杂的路由逻辑。</li>
<li><strong>应用场景</strong>：需要灵活匹配和过滤消息的场景，如多维度消息分发。</li>
</ul>
</li>
<li><strong>RPC 模式（Remote Procedure Call Mode）</strong>
<ul>
<li><strong>描述</strong>：生产者发送消息后，等待消费者处理并返回结果，类似于远程过程调用。</li>
<li><strong>特点</strong>：通过回调队列实现请求和响应的匹配。</li>
<li><strong>应用场景</strong>：需要同步返回结果的场景，如远程调用。</li>
</ul>
</li>
<li><strong>发布确认模式（Publisher Confirms Mode）</strong>
<ul>
<li><strong>描述</strong>：生产者在发送消息后，等待 RabbitMQ 的确认，确保消息被成功接收。</li>
<li><strong>特点</strong>：提高消息的可靠性，避免消息丢失。</li>
<li><strong>应用场景</strong>：需要高可靠性的消息传递，如金融交易。</li>
</ul>
</li>
<li><strong>Header 模式（Headers Mode）</strong>
<ul>
<li><strong>描述</strong>：根据消息的头部信息（Headers）进行路由，而不是依赖路由键。</li>
<li><strong>特点</strong>：使用 <strong>headers</strong> 类型的交换机，支持复杂的匹配规则。</li>
<li><strong>应用场景</strong>：需要根据消息属性进行路由的场景。</li>
</ul>
</li>
</ul>
<h2 id="rabbitmq有哪些类型的路由键">
  rabbitmq有哪些类型的路由键
  <a class="anchor" href="#rabbitmq%e6%9c%89%e5%93%aa%e4%ba%9b%e7%b1%bb%e5%9e%8b%e7%9a%84%e8%b7%af%e7%94%b1%e9%94%ae">#</a>
</h2>
<p>在 RabbitMQ 中，<strong>路由键（Routing Key）</strong> 是用于决定消息如何被路由到队列的关键字。路由键的具体使用方式取决于 <strong>交换机类型</strong>，不同类型的交换机对路由键的处理方式不同。以下是 RabbitMQ 中常见的交换机类型及其对应的路由键使用方式：</p>
<hr>
<ul>
<li><strong>直连交换机（Direct Exchange）</strong>
<ul>
<li><strong>路由键规则</strong>：路由键必须与 <strong>绑定键（Binding Key）</strong> 完全匹配。</li>
<li><strong>特点</strong>：消息会被精确地路由到绑定键与路由键完全匹配的队列。</li>
<li><strong>示例</strong>：如果队列绑定键为 <code>error</code>，则只有路由键为 <code>error</code> 的消息会被路由到该队列。</li>
</ul>
</li>
<li><strong>主题交换机（Topic Exchange）</strong>
<ul>
<li><strong>路由键规则</strong>：路由键支持通配符匹配。
<ul>
<li><code>*</code> 匹配一个单词（如 <code>quick.orange.rabbit</code> 匹配 <code>quick.orange.*</code>）。</li>
<li><code>#</code> 匹配零个或多个单词（如 <code>lazy.#</code> 匹配 <code>lazy.orange.rabbit</code> 和 <code>lazy.dog</code>）。</li>
</ul>
</li>
<li><strong>特点</strong>：支持灵活的路由规则，适用于复杂的消息分发场景。</li>
<li><strong>示例</strong>：路由键 <code>quick.orange.rabbit</code> 会匹配绑定键 <code>quick.orange.*</code> 和 <code>*.rabbit</code> 的队列。</li>
</ul>
</li>
<li><strong>扇出交换机（Fanout Exchange）</strong>
<ul>
<li><strong>路由键规则</strong>：忽略路由键。</li>
<li><strong>特点</strong>：将消息广播到所有绑定到该交换机的队列，路由键对消息路由没有影响。</li>
<li><strong>示例</strong>：无论路由键是什么，消息都会被发送到所有绑定队列。</li>
</ul>
</li>
<li><strong>头交换机（Headers Exchange）</strong>
<ul>
<li><strong>路由键规则</strong>：不使用路由键，而是根据消息的 <strong>头部属性（Headers）</strong> 进行匹配。</li>
<li><strong>特点</strong>：通过键值对匹配消息和队列，适用于需要基于消息属性进行路由的场景。</li>
<li><strong>示例</strong>：如果队列绑定规则要求消息头部包含 <code>type=error</code>，则只有满足该条件的消息会被路由到该队列。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>总结
<ul>
<li><strong>直连交换机</strong>：完全匹配路由键和绑定键。</li>
<li><strong>主题交换机</strong>：支持通配符匹配，灵活性高。</li>
<li><strong>扇出交换机</strong>：忽略路由键，广播消息。</li>
<li><strong>头交换机</strong>：基于消息头部属性匹配，不使用路由键。</li>
</ul>
</li>
</ul>
<h2 id="核心组件">
  核心组件
  <a class="anchor" href="#%e6%a0%b8%e5%bf%83%e7%bb%84%e4%bb%b6">#</a>
</h2>
<ul>
<li><strong>Broker（服务器）</strong>
<ul>
<li>负责接收和分发消息的应用，RabbitMQ Server 就是 Message Broker。</li>
</ul>
</li>
</ul>
<ol start="2">
<li><strong>Virtual Host（虚拟主机）</strong>
<ul>
<li>用于逻辑隔离，类似于网络中的 namespace 概念。多个用户可以共享同一个 RabbitMQ Server，但每个用户在自己的 vhost 中创建 exchange、queue 等。</li>
</ul>
</li>
<li><strong>Connection（连接）</strong>
<ul>
<li>生产者（Producer）和消费者（Consumer）与 Broker 之间的 TCP 连接。</li>
</ul>
</li>
<li><strong>Channel（信道）</strong>
<ul>
<li>在 Connection 内部建立的逻辑连接，用于执行 AMQP 操作。每个线程通常对应一个 Channel，以减少 TCP 连接的开销。</li>
</ul>
</li>
<li><strong>Exchange（交换机）</strong>
<ul>
<li>消息到达 Broker 的第一站，根据分发规则将消息路由到队列。常见的类型包括 direct、topic 和 fanout。</li>
</ul>
</li>
<li><strong>Queue（队列）</strong>
<ul>
<li>消息最终被送到队列中，等待消费者取走。</li>
</ul>
</li>
<li><strong>Binding（绑定）</strong>
<ul>
<li>交换机和队列之间的虚拟连接，binding 中可以包含 routing key，用于消息的分发依据。</li>
</ul>
</li>
<li><strong>Message（消息）</strong>
<ul>
<li>由生产者发送并通过交换机路由到队列的数据单元，通常由头部（元数据）和正文（负载数据）组成。</li>
</ul>
</li>
<li><strong>Producer（生产者）</strong>
<ul>
<li>创建并发布消息的应用程序，负责将消息发送到 RabbitMQ。</li>
</ul>
</li>
<li><strong>Consumer（消费者）</strong>
<ul>
<li>从队列中获取并处理消息的应用程序。</li>
</ul>
</li>
<li><strong>AMQP（高级消息队列协议）</strong>
<ul>
<li>RabbitMQ 使用的通信协议，确保不同系统间的互操作性。</li>
</ul>
</li>
</ol>
<p>这些组件共同构成了 RabbitMQ 的核心架构，使其能够高效地处理消息传递任务。</p>
<h2 id="rabbit可以实现高吞吐量吗">
  Rabbit可以实现高吞吐量吗
  <a class="anchor" href="#rabbit%e5%8f%af%e4%bb%a5%e5%ae%9e%e7%8e%b0%e9%ab%98%e5%90%9e%e5%90%90%e9%87%8f%e5%90%97">#</a>
</h2>
<ul>
<li>是的，RabbitMQ 可以实现高吞吐量，但其性能表现取决于具体的配置和使用场景。以下是一些关键点和优化策略，可以帮助 RabbitMQ 实现更高的吞吐量：</li>
<li><strong>RabbitMQ 的吞吐量表现</strong>
<ul>
<li>RabbitMQ 的吞吐量通常在 <strong>万级到十万级消息每秒</strong>，虽然相比 Kafka 和 RocketMQ（十万级到百万级）稍低，但在大多数场景下已经足够高效。</li>
<li>其性能受多种因素影响，包括硬件配置、网络带宽、消息大小、持久化设置等。</li>
</ul>
</li>
<li><strong>优化 RabbitMQ 吞吐量的策略</strong>
<ul>
<li>使用 Direct Exchange**
<ul>
<li>Direct Exchange 的吞吐率比 Topic Exchange 快约 2 倍，因为它不需要复杂的路由匹配。</li>
</ul>
</li>
</ul>
</li>
<li><strong>2. 自动确认（Auto ACK）</strong>
<ul>
<li>自动确认比手动确认的吞吐率快约 2 倍，因为减少了确认操作的开销。但自动确认可能会丢失消息，需根据业务需求权衡。</li>
</ul>
</li>
<li><strong>3. 批量消费与确认</strong>
<ul>
<li>在高吞吐量场景下，建议使用 <code>channel.Qos</code> 设置预取数量（prefetchCount），结合缓冲区处理和批量确认（<code>channel.Ack</code> 的 <code>multiple</code> 参数），以减少单条确认的开销。</li>
</ul>
</li>
<li><strong>4. 惰性队列（Lazy Queue）</strong>
<ul>
<li>惰性队列将消息直接存储到磁盘，避免了内存过载和间歇性的 <code>page-out</code> 操作，适合处理大量消息堆积的场景。</li>
</ul>
</li>
<li><strong>5. 集群和镜像模式</strong>
<ul>
<li>镜像模式（Mirror Mode）可以保证数据的高可靠性，同时通过多节点分担负载提高吞吐量。</li>
</ul>
</li>
<li><strong>6. 优化硬件和网络</strong>
<ul>
<li>使用高性能的硬件（如 SSD）和充足的网络带宽，可以显著提升 RabbitMQ 的吞吐量。</li>
</ul>
</li>
<li><strong>7. 消息大小和持久化</strong>
<ul>
<li>较小的消息大小和合理的持久化设置（如仅在必要时启用）可以提高吞吐量。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>RabbitMQ 的吞吐量虽然不及 Kafka 和 RocketMQ，但在 <strong>低延迟</strong> 和 <strong>灵活性</strong> 方面表现更优，适合需要复杂路由和消息顺序性保证的场景。</li>
</ul>
<hr>
<h3 id="4-实际应用建议">
  4. <strong>实际应用建议</strong>
  <a class="anchor" href="#4-%e5%ae%9e%e9%99%85%e5%ba%94%e7%94%a8%e5%bb%ba%e8%ae%ae">#</a>
</h3>
<ul>
<li>如果业务场景对吞吐量要求极高（如日志收集、大数据处理），可以考虑 Kafka 或 RocketMQ。</li>
<li>如果业务场景更注重低延迟、灵活路由和易用性，RabbitMQ 是一个不错的选择，并通过上述优化策略提升其吞吐量。</li>
</ul>
<hr>
<h2 id="集群模式">
  集群模式
  <a class="anchor" href="#%e9%9b%86%e7%be%a4%e6%a8%a1%e5%bc%8f">#</a>
</h2>
<ul>
<li><strong>主备模式（Warren 模式）</strong>
<ul>
<li><strong>描述</strong>：主备模式是一种简单的高可用方案，通常用于并发量和数据量不高的场景。主节点提供读写服务，而备节点仅作为备份，不提供读写服务。当主节点宕机时，备节点会自动切换为主节点，继续提供服务。</li>
<li><strong>特点</strong>：
- 主节点提供读写，备节点仅备份。
- 配置简单，适合中小规模应用。</li>
<li><strong>应用场景</strong>：中小型系统，对高可用性要求不高的场景。</li>
</ul>
</li>
<li><strong>镜像模式（Mirror 模式）</strong>
<ul>
<li><strong>描述</strong>：镜像模式是 RabbitMQ 最常用的集群模式，确保数据的高可靠性。在这种模式下，队列中的消息会在多个节点之间同步，即使某个节点宕机，数据也不会丢失。</li>
<li><strong>特点</strong>：
- 消息和元数据在所有节点间同步。
- 通常需要 2-3 个节点来实现数据同步，保证 100% 数据不丢失。
- 适合对数据可靠性要求高的场景。</li>
<li><strong>应用场景</strong>：互联网大厂、金融系统等对数据可靠性要求极高的场景。</li>
</ul>
</li>
<li><strong>多活模式（Federation 模式）</strong>
<ul>
<li><strong>描述</strong>：多活模式用于实现异地数据复制，适合跨地域的 RabbitMQ 集群。通过 Federation 插件，可以在不同数据中心之间复制消息，实现高可用性和负载均衡。</li>
<li><strong>特点</strong>：
- 支持跨地域的消息复制。
- 配置复杂，但可以实现高可用性和负载均衡。
- 适合需要异地灾备和多中心部署的场景。</li>
<li><strong>应用场景</strong>：跨地域的分布式系统，如全球化的电商平台。</li>
</ul>
</li>
<li><strong>远程模式（Shovel 模式）</strong>
<ul>
<li><strong>描述</strong>：远程模式用于将消息从本地集群复制到远程集群，适合处理高负载场景。通过 Shovel 插件，可以将部分消息路由到远程集群进行处理。</li>
<li><strong>特点</strong>：
- 支持异步消息复制。
- 配置较为复杂，适合处理高负载场景。
- 目前已较少使用，多被多活模式替代。</li>
<li><strong>应用场景</strong>：早期的高负载处理场景。</li>
</ul>
</li>
<li><strong>默认集群模式（普通集群模式）</strong>
<ul>
<li><strong>描述</strong>：默认集群模式下，RabbitMQ 仅同步元数据（如队列、交换机、绑定关系等），而不会同步队列中的消息内容。消息仅存储在创建队列的节点上，其他节点只保存元数据和指向该节点的指针。</li>
<li><strong>特点</strong>：
- 消息不复制，节省存储空间。
- 节点故障时，消息可能丢失。
- 适合对消息可靠性要求不高的场景。</li>
<li><strong>应用场景</strong>：测试环境或对消息可靠性要求较低的场景。</li>
</ul>
</li>
</ul>
<h2 id="rabbitmq的集群模式在实际项目中如何选型">
  RabbitMQ的集群模式在实际项目中如何选型
  <a class="anchor" href="#rabbitmq%e7%9a%84%e9%9b%86%e7%be%a4%e6%a8%a1%e5%bc%8f%e5%9c%a8%e5%ae%9e%e9%99%85%e9%a1%b9%e7%9b%ae%e4%b8%ad%e5%a6%82%e4%bd%95%e9%80%89%e5%9e%8b">#</a>
</h2>
<ul>
<li><strong>中小规模系统，对高可用性要求不高</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>主备模式（Warren 模式）</strong></li>
<li><strong>特点</strong>：
- 配置简单，易于维护。
- 主节点提供读写服务，备节点作为备份。
- 当主节点宕机时，备节点自动切换为主节点。</li>
<li><strong>适用场景</strong>：
- 中小型系统，消息量不大。
- 对高可用性要求不高，允许短暂的服务中断。</li>
</ul>
</li>
<li><strong>对数据可靠性要求高，需要消息不丢失</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>镜像模式（Mirror 模式）</strong></li>
<li><strong>特点</strong>：
- 消息和元数据在所有节点间同步，保证数据不丢失。
- 通常需要 2-3 个节点来实现数据同步。
- 适合对数据可靠性要求极高的场景。</li>
<li><strong>适用场景</strong>：
- 金融、支付等对数据可靠性要求高的系统。
- 互联网大厂的核心业务系统。</li>
</ul>
</li>
<li><strong>跨地域部署，需要异地灾备和多中心高可用</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>多活模式（Federation 模式）</strong></li>
<li><strong>特点</strong>：
- 支持跨地域的消息复制，实现异地灾备。
- 配置复杂，但可以实现高可用性和负载均衡。
- 适合需要异地灾备和多中心部署的场景。</li>
<li><strong>适用场景</strong>：
- 全球化的电商平台或分布式系统。
- 需要跨地域高可用的业务。</li>
</ul>
</li>
<li><strong>高负载场景，需要分担消息处理压力</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>远程模式（Shovel 模式）</strong></li>
<li><strong>特点</strong>：
- 将部分消息路由到远程集群进行处理，分担负载。
- 配置较为复杂，目前已较少使用，多被多活模式替代。</li>
<li><strong>适用场景</strong>：
- 早期的高负载处理场景。
- 需要分担消息处理压力的系统。</li>
</ul>
</li>
<li><strong>测试环境或对消息可靠性要求较低</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>默认集群模式（普通集群模式）</strong></li>
<li><strong>特点</strong>：
- 仅同步元数据（如队列、交换机、绑定关系等），消息不复制。
- 节点故障时，消息可能丢失。
- 配置简单，适合测试环境或对消息可靠性要求较低的场景。</li>
<li><strong>适用场景</strong>：
<ul>
<li>开发测试环境。</li>
<li>对消息可靠性要求较低的业务。</li>
</ul>
</li>
</ul>
</li>
<li><strong>需要灵活的路由和消息分发</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>镜像模式 + 多活模式</strong></li>
<li><strong>特点</strong>：
- 结合镜像模式的高可靠性和多活模式的跨地域能力。
- 实现灵活的路由和消息分发，同时保证数据可靠性。</li>
<li><strong>适用场景</strong>：
- 复杂的分布式系统，需要灵活的消息路由和高可靠性。</li>
</ul>
</li>
<li><strong>需要高吞吐量和低延迟</strong>
<ul>
<li><strong>推荐模式</strong>：<strong>镜像模式 + 优化配置</strong></li>
<li><strong>特点</strong>：
- 通过镜像模式保证数据可靠性，同时优化配置（如 Direct Exchange、自动确认、批量处理等）提升吞吐量。
- 适合对吞吐量和延迟要求较高的场景。</li>
<li><strong>适用场景</strong>：
- 高并发的消息处理系统，如实时交易系统。</li>
</ul>
</li>
</ul>
<h2 id="rabbitmq可以像kafka一样把消费者平均分配到所有broker上吗">
  rabbitmq可以像kafka一样把消费者平均分配到所有broker上吗
  <a class="anchor" href="#rabbitmq%e5%8f%af%e4%bb%a5%e5%83%8fkafka%e4%b8%80%e6%a0%b7%e6%8a%8a%e6%b6%88%e8%b4%b9%e8%80%85%e5%b9%b3%e5%9d%87%e5%88%86%e9%85%8d%e5%88%b0%e6%89%80%e6%9c%89broker%e4%b8%8a%e5%90%97">#</a>
</h2>
<ul>
<li>RabbitMQ 和 Kafka 在消费者分配机制上有显著差异，<strong>RabbitMQ 并不能像 Kafka 一样将消费者平均分配到所有 Broker 上</strong>。以下是两者的具体对比：
<ul>
<li><strong>RabbitMQ 的消费者分配机制</strong>
<ul>
<li>在 RabbitMQ 中，消费者是直接绑定到队列的，而队列是创建在特定的 Broker 上的。因此，消费者的分配取决于队列的分布：
<ul>
<li><strong>队列分布</strong>：一个队列只能存在于一个 Broker 上，即使是在集群模式下，队列也不会自动分布在多个 Broker 上。</li>
<li><strong>消费者分配</strong>：消费者连接到队列所在的 Broker，因此消费者的分布取决于队列的位置。如果一个队列在一个 Broker 上，那么所有消费该队列的消费者都会连接到这个 Broker。</li>
<li><strong>镜像队列</strong>：为了提高可用性，RabbitMQ 支持镜像队列（Mirrored Queue），将队列复制到多个 Broker 上。但这只是数据的冗余备份，消费者的连接仍然集中在主队列所在的 Broker 上。</li>
</ul>
</li>
</ul>
</li>
<li><strong>Kafka 的消费者分配机制</strong>
<ul>
<li>在 Kafka 中，消费者是基于分区（Partition）进行分配的，而分区可以分布在多个 Broker 上：
<ul>
<li><strong>分区分布</strong>：一个主题（Topic）可以分为多个分区，每个分区可以分布在不同的 Broker 上。</li>
<li><strong>消费者分配</strong>：消费者组中的消费者会分配到不同的分区，从而实现负载均衡。Kafka 会自动将分区均匀地分配给消费者组中的消费者。</li>
<li><strong>动态扩展</strong>：Kafka 支持动态增加分区和消费者，从而实现横向扩展。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr>
<p><strong>RabbitMQ 与 Kafka 的对比</strong></p>
<table>
  <thead>
      <tr>
          <th><strong>特性</strong></th>
          <th><strong>RabbitMQ</strong></th>
          <th><strong>Kafka</strong></th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td><strong>消费者分配</strong></td>
          <td>消费者绑定到队列，队列位于单个 Broker 上</td>
          <td>消费者分配到分区，分区分布在多个 Broker 上</td>
      </tr>
      <tr>
          <td><strong>负载均衡</strong></td>
          <td>需要手动配置镜像队列或多队列实现负载均衡</td>
          <td>自动将分区均匀分配给消费者组</td>
      </tr>
      <tr>
          <td><strong>扩展性</strong></td>
          <td>扩展性有限，依赖于队列的分布</td>
          <td>支持动态增加分区和消费者，扩展性强</td>
      </tr>
      <tr>
          <td><strong>适用场景</strong></td>
          <td>适合低延迟、复杂路由的场景</td>
          <td>适合高吞吐量、流数据处理的场景</td>
      </tr>
  </tbody>
</table>
<hr>
<ul>
<li><strong>如何实现 RabbitMQ 的负载均衡</strong>
<ul>
<li>虽然 RabbitMQ 不能像 Kafka 那样自动将消费者分配到所有 Broker 上，但可以通过以下方式实现负载均衡：
<ul>
<li><strong>多队列策略</strong>：为同一个主题创建多个队列，并将消费者分布到不同的队列上。</li>
<li><strong>镜像队列</strong>：使用镜像队列提高可用性，但消费者的连接仍然集中在主队列所在的 Broker 上。</li>
<li><strong>客户端负载均衡</strong>：在客户端实现逻辑，将消费者均匀地分配到不同的 Broker 上。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="rabbitmq-为什么不能保证消息的顺序性">
  rabbitmq 为什么不能保证消息的顺序性
  <a class="anchor" href="#rabbitmq-%e4%b8%ba%e4%bb%80%e4%b9%88%e4%b8%8d%e8%83%bd%e4%bf%9d%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e9%a1%ba%e5%ba%8f%e6%80%a7">#</a>
</h2>
<ul>
<li><strong>多个消费者并发消费同一个队列</strong>
<ul>
<li><strong>问题</strong>：当多个消费者同时消费同一个队列时，RabbitMQ 会将消息分发给不同的消费者。由于每个消费者的处理速度不同，可能会导致消息的消费顺序与发送顺序不一致。</li>
<li><strong>示例</strong>：如果消息 A、B、C 按顺序进入队列，消费者 1 拿到消息 A，消费者 2 拿到消息 B，但消费者 2 处理速度更快，导致消息 B 先于消息 A 被处理。</li>
</ul>
</li>
<li><strong>消费者内部多线程处理</strong>
<ul>
<li><strong>问题</strong>：即使一个队列只有一个消费者，如果消费者内部使用多线程处理消息，不同线程的执行顺序也可能导致消息的消费顺序错乱。</li>
<li><strong>示例</strong>：消费者内部将消息 A 和 B 分配给不同的线程处理，线程 2 先处理消息 B，线程 1 后处理消息 A，导致顺序错乱。</li>
</ul>
</li>
<li><strong>网络延迟或重试机制</strong>
<ul>
<li><strong>问题</strong>：消息在传输过程中可能因网络延迟或消费者处理失败而触发重试机制，导致消息的到达顺序与发送顺序不一致。</li>
</ul>
</li>
<li><strong>复杂的交换器和队列配置</strong>
<ul>
<li><strong>问题</strong>：使用复杂的交换器配置（如 Topic Exchange）可能会将消息路由到不同的队列中，这些队列的消费顺序无法保证。</li>
</ul>
</li>
<li><strong>RabbitMQ 的设计机制</strong>
<ul>
<li><strong>RabbitMQ 的设计目标是高吞吐量和高可用性，而不是严格的消息顺序性</strong>。它通过并发消费和负载均衡来提高性能，但这也会导致消息顺序的不可控。</li>
</ul>
</li>
</ul>
<hr>
<ul>
<li>如果需要保证消息顺序性，可以通过以下方式解决：
<ul>
<li><strong>单一消费者模式</strong>：一个队列只绑定一个消费者。</li>
<li><strong>消息分区策略</strong>：将相关消息路由到同一个队列，确保顺序性。</li>
<li><strong>消费者内部排序</strong>：在消费者端使用内存队列对消息进行排序。</li>
</ul>
</li>
</ul>
<h2 id="如果只有一个生产者一个消费者消费者是单线程的能保证消息的顺序性吗">
  如果只有一个生产者一个消费者，消费者是单线程的，能保证消息的顺序性吗
  <a class="anchor" href="#%e5%a6%82%e6%9e%9c%e5%8f%aa%e6%9c%89%e4%b8%80%e4%b8%aa%e7%94%9f%e4%ba%a7%e8%80%85%e4%b8%80%e4%b8%aa%e6%b6%88%e8%b4%b9%e8%80%85%e6%b6%88%e8%b4%b9%e8%80%85%e6%98%af%e5%8d%95%e7%ba%bf%e7%a8%8b%e7%9a%84%e8%83%bd%e4%bf%9d%e8%af%81%e6%b6%88%e6%81%af%e7%9a%84%e9%a1%ba%e5%ba%8f%e6%80%a7%e5%90%97">#</a>
</h2>
<ul>
<li>是的，如果只有一个生产者、一个消费者，并且消费者是单线程的，<strong>RabbitMQ 可以保证消息的顺序性</strong>。以下是具体原因和机制：
<ul>
<li><strong>生产者发送顺序</strong>
<ul>
<li>生产者将消息顺序发送到 RabbitMQ 的队列中。RabbitMQ 的队列是先进先出（FIFO）的，因此消息会按照发送顺序存储在队列中。</li>
</ul>
</li>
<li><strong>消费者单线程消费</strong>
<ul>
<li>消费者是单线程的，意味着它一次只处理一条消息，处理完一条消息后才会从队列中取出下一条消息。这种方式确保了消息按照队列中的顺序被消费。</li>
</ul>
</li>
<li><strong>队列的 FIFO 特性</strong>
<ul>
<li>RabbitMQ 的队列本身是 FIFO 数据结构，只要消费者是单线程的，消息就会按照进入队列的顺序被处理。</li>
</ul>
</li>
<li><strong>注意事项</strong>
<ul>
<li><strong>网络延迟</strong>：虽然生产者和消费者是单线程的，但在极端情况下（如网络延迟或重试机制），可能会导致消息到达队列的顺序与发送顺序不一致。这种情况非常罕见，但在高要求场景下仍需注意。</li>
<li><strong>消费者内部逻辑</strong>：如果消费者在处理消息时引入了异步操作（如多线程或异步回调），可能会破坏消息的顺序性。</li>
</ul>
</li>
</ul>
</li>
</ul>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">


  <div><a class="flex align-center" href="https://github.com/penruins/penruins.github.io/commit/37b02a4959b9b8520a34fc7025e99ff78504a200" title='Last modified by liuxiang | September 9, 2025' target="_blank" rel="noopener">
      <img src="/svg/calendar.svg" class="book-icon" alt="" />
      <span>September 9, 2025</span>
    </a>
  </div>




</div>



  <script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){if(window.getSelection().toString())return;e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script>


 
        
      </footer>

      
  
  <div class="book-comments">

</div>
  
 

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
    <aside class="book-toc">
      <div class="book-toc-content">
        
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#rabbitmq">rabbitmq</a></li>
    <li><a href="#main">main</a>
      <ul>
        <li><a href="#rabbitmq有哪几种模式">rabbitmq有哪几种模式</a></li>
        <li><a href="#rabbitmq有哪些类型的路由键">rabbitmq有哪些类型的路由键</a></li>
        <li><a href="#核心组件">核心组件</a></li>
        <li><a href="#rabbit可以实现高吞吐量吗">Rabbit可以实现高吞吐量吗</a>
          <ul>
            <li><a href="#4-实际应用建议">4. <strong>实际应用建议</strong></a></li>
          </ul>
        </li>
        <li><a href="#集群模式">集群模式</a></li>
        <li><a href="#rabbitmq的集群模式在实际项目中如何选型">RabbitMQ的集群模式在实际项目中如何选型</a></li>
        <li><a href="#rabbitmq可以像kafka一样把消费者平均分配到所有broker上吗">rabbitmq可以像kafka一样把消费者平均分配到所有broker上吗</a></li>
        <li><a href="#rabbitmq-为什么不能保证消息的顺序性">rabbitmq 为什么不能保证消息的顺序性</a></li>
        <li><a href="#如果只有一个生产者一个消费者消费者是单线程的能保证消息的顺序性吗">如果只有一个生产者一个消费者，消费者是单线程的，能保证消息的顺序性吗</a></li>
      </ul>
    </li>
  </ul>
</nav>


 
      </div>
    </aside>
    
  </main>

  
</body>
</html>












